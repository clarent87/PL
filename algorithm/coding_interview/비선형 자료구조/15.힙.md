# 15ì¥. í™

## í™ ê°œë…

- ì •ì˜
  - í™ì€ í™ì˜ íŠ¹ì„±ì„ ë§Œì¡±í•˜ëŠ” ê±°ì˜ ì™„ì „í•œ íŠ¸ë¦¬ì¸ íŠ¹ìˆ˜í•œ **íŠ¸ë¦¬ê¸°ë°˜ì˜ ìë£Œêµ¬ì¡°**
    - í™ì˜ íŠ¹ì„±
      - ìµœì†Œí™ (min heap)ì—ì„œëŠ” ë¶€ëª¨ê°€ í•­ìƒ ìì‹ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ë‹¤
    - ê±°ì˜ ì™„ì „í•œ íŠ¸ë¦¬
      - almost complete tree

- íŒŒì´ì¬ heapq ëª¨ë“ˆ
  - ì´ê²Œ í™ì„
  - íŒŒì´ì¬ì—ì„œëŠ” min heapë§Œ êµ¬í˜„ë˜ì–´ ìˆìŒ (ê·¼ë° ë‘ë²ˆì§¸ íŒŒëŒì„ ì¤˜ì„œ ë³€ê²½ê°€ëŠ¥í•˜ì§€..)
  - ìš°ì„ ìˆœìœ„ í ë§Œë“¤ë–„ ì‚¬ìš©í–ˆìŒ.

- ìš°ì„ ìˆœìœ„í(ADT) ëŠ” ì£¼ë¡œ í™ìœ¼ë¡œ êµ¬í˜„í•˜ê³  í™ì€ ì£¼ë¡œ ë°°ì—´ë¡œ êµ¬í˜„
  - heapq ì‚¬ìš©ë²•ì„ ë³´ë©´ ë°°ì—´ì„ ë„˜ê¸°ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆìŒ ( heap ì €ì¥ì—..)
  - ë”°ë¼ì„œ ìš°ì„ ìˆœìœ„ íëŠ” ê²°êµ­ ë°°ì—´ë¡œ êµ¬í˜„í•˜ëŠ” ì…ˆ.

- ì°©ê°í•˜ê¸° ì‰¬ìš´ê²ƒ
  - í™ì€ ì •ë ¬ëœ êµ¬ì¡°ëŠ” ì•„ë‹˜
  - ë‹¨ì§€, min heapì¼ë• ë¶€ëª¨ê°€ ìì‹ë³´ë‹¤ ì‘ë‹¤ëŠ” ê·œì¹™ë§Œ ë§ì„ë¿..

- ì´ì§„ í™ (binary heap)
  - ìì‹ì´ ë‘˜ì¸ í™
  - ëŒ€ë¶€ë¶„ ì´ì§„ í™ì´ ì‚¬ìš©ë¨
  - ì´ì§„ íŠ¸ë¦¬ê°€ ë„ë¦¬ ì‚¬ìš©ë˜ëŠ” ì´ìœ ì™€ ë¹„ìŠ·
    - > ê°„ê²°í•˜ê³  ì•Œê³ ë¦¬ì¦˜ êµ¬í˜„ì´ ìˆ˜ì›”í•´ì„œ..

- í™
  - í™ ìë£Œêµ¬ì¡°ëŠ” ì‚¬ì‹¤ í™ì •ë ¬ì˜ ë¶€ì‚°ë¬¼ì„
  - í™ì€ **ì™„ì „ ì´ì§„ íŠ¸ë¦¬**
    - ë”°ë¼ì„œ ë°°ì—´ì— ìˆœì„œëŒ€ë¡œ í‘œí˜„í•˜ê¸° ì í•©
    - > ì¦‰ ê³µë°± ì—†ì´ ë°°ì—´ì— í‘œí˜„ê°€ëŠ¥

- ëŒ€ê²Œ íŠ¸ë¦¬ì˜ ë°°ì—´ í‘œí˜„ì˜ ê²½ìš°
  - ê³„ì‚°ì„ í¸í•˜ê²Œ í•˜ê¸° ìœ„í•´ ì¸ë±ìŠ¤ë¥¼ 1ë¶€í„° ì‚¬ìš©
  - 297. ì´ì§„ íŠ¸ë¦¬ ì§ë ¬í™” & ì—­ì§ë ¬í™” ì—ì„œë„ ë§í–ˆë“¯, íŠ¸ë¦¬(ì´ì§„)ë¥¼ ë°°ì—´ í‘œí˜„í• ë• ë¬´ì¡°ê±´ indexëŠ” 1ë¶€í„° ì‹œì‘.

- í™ì€ í•­ìƒ ê· í˜•ì„ ìœ ì§€
  - > heapqë„ ê·¸ë¬ìŒ
  - ë”°ë¼ì„œ ì—¬ëŸ¬ ë¶„ì•¼ì— ì‚¬ìš©ë¨
    - ëŒ€í‘œì ìœ¼ë¡œ ìš°ì„ ìˆœìœ„ í ì´ë¥¼ í™œìš©í•œ ë‹¤ìµìŠ¤íŠ¸ë¼
      - ë‹¤ìµìŠ¤íŠ¸ë¼ì˜ O(V^2) ì˜ ì‹œê°„ ë³µì¡ë„ê°€ í™ ë•ë¶„ì— O(E logV)ê°€ ë¨.
    - ì›ë˜ ìš©ë„ì¸ í™ ì •ë ¬, ìµœì†Œ ì‹ ì¥ íŠ¸ë¦¬ë¥¼ êµ¬í˜„í•˜ëŠ” í”„ë¦¼ ì•Œê³ ë¦¬ì¦˜ ë“±ì— í™œìš©ë¨
    - ì¤‘ì•™ê°’ì˜ ê·¼ì‚¬ê°’ì„ ë¹ ë¥´ê²Œ êµ¬í•˜ëŠ”ë°ë„ ì‚¬ìš©
      - ì™„ì „ ì´ì§„ íŠ¸ë¦¬ë¼ì„œ, ì ì ˆíˆ ì¤‘ê°„ ë ˆë²¨ì˜ ë…¸ë“œë¥¼ ì¶”ì¶œí•˜ë©´ ì¤‘ì•™ê°’ì— ê°€ê¹Œìš´ ê°’ì´ ë‚˜ì˜´ ( ê·¼ì‚¬ì¹˜)

- ì™„ì „ ì´ì§„ íŠ¸ë¦¬ê°€ ê°€ëŠ¥í•œ ì´ìœ 
  - ì‚½ì…ì„ ë§¨ë’¤ì— ë‹¤ê°€ í•˜ë‹ˆê¹Œ.
  - ê·¸ë¦¬ê³  ë§Œë“¤ì–´ì§„ ëª¨ì–‘ìƒˆ ëŒ€ë¡œ ê· í˜•ì„ ì¡ê¸°ìœ„í•œ ì‘ì—…ì´ ì§„í–‰ë˜ë‹ˆê¹Œ
  - ì¶”ì¶œë„ ë§ˆì°¬ê°€ì§€.. ë£¨íŠ¸ ë¹¼ê³ , ë§¨ë’¤ë¥¼ ë¹¼ì„œ ë£¨íŠ¸ì— ë„£ê³ , ê· í˜• ì¡ëŠ” ì‘ì—… ì§„í–‰

## í™ ì—°ì‚°

- í™ êµ¬í˜„
  - íŒŒì´ì¬ì˜ heapq ëª¨ë“ˆì˜ ìµœì†Œ í™ì„ íŒŒì´ì¬ ë¦¬ìŠ¤íŠ¸ ë§Œìœ¼ë¡œ êµ¬í˜„
    - > ëŒ€ê°œ íŠ¸ë¦¬ì˜ ë°°ì—´ í‘œí˜„ì˜ ê²½ìš° ì¸ë±ìŠ¤ëŠ” 1ë¶€í„° ì‚¬ìš©
    - > íŠ¹íˆ ì´ì§„ í™ì—ì„œëŠ” í•­ìƒ 1ë²ˆ ì¸ë±ìŠ¤ ë¶€í„° ì‚¬ìš© !!
    - > ê·¼ë° heapqëŠ” list ë„˜ê¸´ê±° 0ë²ˆë¶€í„° ì±„ìš°ê¸´ í•¨ ğŸ‘

    ```python

    class BinaryHeap(object):
        def __init__(self):
            self.items = [None] # 0ë²ˆ ì¸ë±ìŠ¤ëŠ” ì‚¬ìš©í•˜ì§€ ì•Šê¸° ìœ„í•´None ì„¸íŒ…

        def __len__(self):
            return len(self.items) - 1 # ì¼ë¶€ëŸ¬ -1í•¨ indexê°€ ë‚˜ì˜¤ê²Œ í•˜ê¸° ìœ„í•´

        # ì‚½ì… ì‹œ ì‹¤í–‰, ë°˜ë³µ êµ¬ì¡° êµ¬í˜„
        def _percolate_up(self): # ì‚½ì…ì„ ìœ„í•œ ì—… í™ì—°ì‚°. ì¼ë°˜ì ìœ¼ë¡œ percolate_up ì´ë¼ëŠ” í•¨ìˆ˜ë¡œ ì •ì˜
            i = len(self) # ë§ˆì§€ë§‰ ìš”ì†Œ index 
            
            parent = i // 2
            while parent > 0:
                if self.items[i] < self.items[parent]: # parent ê°’ì´ë‘ ë¹„êµí•´ì„œ parent ë³´ë‹¤ ì‘ìœ¼ë©´ êµì²´
                    self.items[parent], self.items[i] = self.items[i], self.items[parent]
                i = parent # ì´ì œ í˜„ì¬ ë…¸ë“œëŠ” parentê°€ ëœë‹¤. 
                parent = i // 2 # ë°˜ë³µ

        def insert(self, k):
            self.items.append(k)
            self._percolate_up()

        # ì¶”ì¶œ ì‹œ ì‹¤í–‰, ì¬ê·€ êµ¬ì¡° êµ¬í˜„
        def _percolate_down(self, idx):
            left = idx * 2
            right = idx * 2 + 1
            smallest = idx # ì¼ë‹¨ ë£¨íŠ¸ê°€ ê°€ì¥ ì‘ë‹¤ê³  ê°€ì • ( ë§Œì•½ ì•„ë‹ˆë¼ë©´ ë°”ë€Œê² ì§€..)

            if left <= len(self) and self.items[left] < self.items[smallest]:
                smallest = left  # ì¼ë‹¨ leftê°€ ì‘ë‹¤ë©´ leftì˜ indexë¥¼ smallestì— ì €ì¥

            if right <= len(self) and self.items[right] < self.items[smallest]:
                smallest = right # ì¼ë‹¨ rightê°€ ì‘ë‹¤ë©´ rightì˜ indexë¥¼ smallestì— ì €ì¥

            # ìµœì†Œí™ì€ ë¶€ëª¨ê°€ ìì‹ë³´ë‹¤ ì‘ì€ê²ƒ. ìì‹ ì™¼ìª½, ì˜¤ë¥¸ìª½ì€ ì˜ë¯¸ê°€ ì—†ì–´ì„œ ì•„ë¬´ìª½ì— ë„£ì–´ë„ ë˜ê² ì§€ë§Œ..
            # ì•Œê³ ë¦¬ì¦˜ìƒ ì™¼ìª½, ì˜¤ë¥¸ìª½ ì¤‘ ì‘ì€ìª½ indexë¥¼ ì°¾ê¸°ëŠ” í•¨.. 

            if smallest != idx: # í˜„ì¬ ë…¸ë“œê°€ ìì‹ë³´ë‹¤ ì‘ì€ ê²½ìš°ê°€ smallest == idx ì„
                self.items[idx], self.items[smallest] = self.items[smallest], self.items[idx]
                self._percolate_down(smallest)

        def extract(self):
            extracted = self.items[1] # ë£¨íŠ¸ë¥¼ ë¹¼ì„œ ë°˜í™˜í•´ì¤Œ.
            self.items[1] = self.items[len(self)] # ë£¨íŠ¸ì— ë§¨ë’¤ ê°’ì„ ë„£ìŒ.
            self.items.pop() # ë§¨ë’¤ì—êº¼ ì œê±° ( ì¦‰, ë§¨ë’¤ ë…¸ë“œë¥¼ ë£¨íŠ¸ë¡œ ì˜¬ë¦°ê²ƒ)
            self._percolate_down(1) # ì‹œì‘ indexëŠ” 1ë¶€í„°.
            return extracted


    b = BinaryHeap()

    # ì‚½ì…
    b.insert(5)
    b.insert(9)
    b.insert(17)
    b.insert(27)
    b.insert(11)
    b.insert(14)
    b.insert(21)
    b.insert(33)
    b.insert(19)
    b.insert(18)
    print(b.items)

    # ì¶”ì¶œ
    for _ in range(5):
        print(b.extract(), end=' ')

    ```

- `_percolate_up`
  - ë‚´ë¶€ í•©ìˆ˜ë¼ëŠ” ì˜ë¯¸ë¡œ ì´ë¦„ì— _ë¥¼ ë¶™ì„
  - pep8 ê¸°ì¤€ê³¼ ê´€ë¡€ì— ë”°ë¦„ ğŸ‘
- í™ ì—°ì‚°ì€ ìœ„ì™€ ê°™ì´ êµ¬í˜„í–ˆëŠ”ë°, í™ ì—°ì‚°ì€ ì•„ë˜ ë‘ê°œê°€ ìˆìŒ

- ì‚½ì…
  - ì—…í™ ì—°ì‚°ì„ í•´ì•¼í•¨ ( ê°’ì„ ìœ„ë¡œ ì˜¬ë¦°ë‹¤ëŠ” ë§)
    - > ê· í˜•ì„ ë§ì¶°ì•¼ í•´ì„œ
  - 1. ìš”ì†Œë¥¼ ê°€ì¥ í•˜ìœ„ ë ˆë²¨ì˜ ì˜¤ë¥¸ìª½ì— ì‚½ì… (ë°°ì—´ì—ì„  ë§¨ë)
  - 2. ë¶€ëª¨ ê°’ê³¼ ë¹„êµí•´ ê°’ì´ ë” ì‘ì€ ê²½ìš° ìœ„ì¹˜ë¥¼ ë³€ê²½
  - 3. 2ë²ˆ ë°˜ë³µ
  - ì‹œê°„ ë³µì¡ë„ëŠ” O(log n) ğŸ‘

- ì¶”ì¶œ
  - ë£¨íŠ¸ë¥¼ ì¶”ì¶œí•˜ëŠ”ê²ƒ
  - ë‹¤ìš´ í™ ì—°ì‚°ì„ í•´ì•¼í•¨ (ê°’ì„ ë‚´ë¦°ë‹¤ëŠ” ë§)
    - > ê· í˜• ë§ì¶°ì•¼ í•´ì„œ
  - ì‹œê°„ ë³µì¡ë„ëŠ” O(log n) ğŸ‘

- ì´ì§„ í™ vs BST
  - í™ : ìƒ/í•˜ ê´€ê³„ë§Œ ë³´ì¥
    - ê°€ì¥ í°ê°’, í˜¹ì€ ê°€ì¥ ì‘ì€ê°’ ì¶”ì¶œí• ë•Œ ì”€ O(1)ê°€ëŠ¥
    - ìš°ì„ ìˆœìœ„ íì— ì‚¬ìš©
  - BST : ë¶€ëª¨ëŠ” ì™¼ìª½ ìì‹ë³´ë‹¤ í¬ì§€ë§Œ, ì˜¤ë¥¸ìª½ ìì‹ ë³´ë‹¨ ì‘ìŒ
    - íƒìƒ‰, ì‚½ì… ëª¨ë‘ O(log n)
    - ëª¨ë“  ê°’ë“¤ì´ ì •ë ¬ë˜ì–´ì•¼ í• ë•Œ ì”€

## 215. ë°°ì—´ì˜ kë²ˆì¨° í° ìš”ì†Œ

- ë¬¸ì œ
  - ì •ë ¬ë˜ì§€ ì•Šì€ ë°°ì—´ì—ì„œ kë²ˆì§¸ í° ìš”ì†Œë¥¼ ì¶”ì¶œí•˜ë¼.
  - > í™ë§Œë“¤ê³  kë²ˆ popí•˜ë©´ ë ë“¯
  - > ì´ë²ˆ ë¬¸ì œëŠ” heapq ëª¨ë“ˆ í™œìš©ë²•ì„ ìµíˆê¸° ìœ„í•¨ ì¸ë“¯.

- í’€ì´1. heapq ëª¨ë“ˆ ì´ìš©
  - 11ì¥ì˜ ìƒìœ„ kë¹ˆë„ ìš”ì†Œì™€ ë¹„ìŠ·í•œ ë¬¸ì œ

  ```python

  import heapq
  from typing import List


  class Solution:
      def findKthLargest(self, nums: List[int], k: int) -> int:
          heap = list()
          for n in nums:
              heapq.heappush(heap, -n) # O( N log N) ì¼ë“¯

          for _ in range(1, k): # ex 7ë²ˆì§¸ ìš”ì†Œë¥¼ ë½‘ìœ¼ë ¤ë©´ 1,2,3,4,5,6 ê¹Œì§€ë§Œ ë½‘ê³  ì•„ë˜ ì˜ returnë¬¸ ëŒì•„ì•¼í•¨
              heapq.heappop(heap)

          return -heapq.heappop(heap) # heapì— ìŒìˆ˜ë¡œ ê°’ì„ ë„£ì—ˆìœ¼ë‹ˆ ë‹¤ì‹œ ì–‘ìˆ˜ë¡œ ì¹˜í™˜

  ```

- í’€ì´2. heapq ëª¨ë“ˆì˜ heapify
  - ë»”í•¨

  ```python

      def findKthLargest(self, nums: List[int], k: int) -> int:
          
          heapq.heapify(nums) # í•œíì— í™ì„ ë§Œë“¬. 

          # min heapì´ë¼ì„œ Kë²ˆì¨° ë¥¼ ë½‘ìœ¼ë ¤ë©´ ì•ì—ì„œ kë²ˆì§¸ê°€ ì•„ë‹Œ ë’¤ì—ì„œ në²ˆì§¸ë¥¼ ë½‘ì„ìˆ˜ ìˆë„ë¡ í•´ì•¼í•¨
          for _ in range(len(nums) - k): 
              heapq.heappop(nums)

          return heapq.heappop(nums)

  ```

- í’€ì´3. heapq ëª¨ë“ˆì˜ nlargest ì´ìš© ğŸ‘
  - heapq ëª¨ë“ˆì€ ê°•ë ¥í•œ ê¸°ëŠ¥ì„ ë§ì´ ì œê³µ, ê·¸ì¤‘ì—ëŠ” në²ˆì§¸ í° ê°’ì„ ì¶”ì¶œí•˜ëŠ” ê¸°ëŠ¥ë„ ìˆìŒ.. ã„·ã„·

  ```python
      def findKthLargest(self, nums: List[int], k: int) -> int:
          # ë‚´ë¶€ì ìœ¼ë¡œ heapifyë„ í˜¸ì¶œí•´ì¤Œ
          # heapq.nlargest(k, nums) ëŠ” ê°€ì¥í° kê°œê°€ listë¡œ ë‚˜ì˜´
          # ë”°ë¼ì„œ [-1] ì¸ë±ìŠ¤ ì¦‰ listì˜ ë§ˆì§€ë§‰ ê°’ì´ kë²ˆì§¸ ê°’ì„
          # nsmallest() ë¼ëŠ” në²ˆì§¸ ì‘ì€ ê°’ ì¶”ì¶œ ê¸°ëŠ¥ë„ ìˆìŒ -> nlargestë‘ ê°™ìŒ ì‚¬ìš©ë²•ìŒ

          return heapq.nlargest(k, nums)[-1]
          
  ```

- í’€ì´4. ì •ë ¬ì„ ì´ìš©í•œ í’€ì´
  - ì •ë ¬í•´ì„œ kë²ˆì§¸ ê°’ì„ ì¶”ì¶œí•˜ëŠ” ë°©ì‹
  - ì¶”ê°€, ì‚­ì œê°€ ë¹ˆë²ˆí•  ë•ŒëŠ” heapqë¥¼ ì´ìš©í•œ í™ì •ë ¬ì´ ìœ ìš©í•˜ì§€ë§Œ, ì…ë ¥ê°’ ê³ ì •ì¼ë•ŒëŠ” ê·¸ëƒ¥ í•œë²ˆ ì •ë ¬í•˜ëŠ”ê²Œ ë‚˜ìŒ ğŸ‘ 
    - > ë§í–ˆë“¯ í™ë§Œë“¤ì—ˆë‹¤ê³  ëª¨ë“  ìš”ì†Œê°€ listì— ì •ë ¬ë˜ì–´ ìˆëŠ”ê±´ ì•„ë‹ˆë‹¤!!!

  ```python
      def findKthLargest(self, nums: List[int], k: int) -> int:
          return sorted(nums, reverse=True)[k - 1] # ì¸ë±ìŠ¤ê°€ 0ë¶€í„° ì‹œì‘ì´ë¼.. k-1 ì„ í•´ì¤Œ

  ```


ì„±ëŠ¥ì€ íŒ€ì†ŒíŠ¸ì¸ sorted ì“´ê²Œ ê°€ì¥ ì¢‹ìŒ.
